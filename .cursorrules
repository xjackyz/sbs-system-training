# SBS System 项目代码规范指南

## 1. 文件组织规范

### 1.1 目录结构
- app/: 应用程序主要代码
- config/: 配置文件
- data/: 数据文件
- docs/: 文档
- logs/: 日志文件
- models/: 模型相关代码
- prompts/: 提示词模板
- scripts/: 工具脚本
- src/: 源代码
- tests/: 测试代码

### 1.2 文件命名
- 使用小写字母
- 单词之间使用下划线连接
- 描述性命名，表明文件用途
- 测试文件以 test_ 开头

## 2. 代码风格规范

### 2.1 Python 代码规范
- 遵循 PEP 8 规范
- 使用 4 空格缩进
- 最大行长度限制为 120 字符
- 类名使用 CamelCase
- 函数和变量名使用 snake_case
- 常量使用大写字母

### 2.2 文档规范
- 所有函数必须包含文档字符串
- 文档字符串使用中文
- 关键函数需要包含参数说明和返回值说明
- 复杂逻辑需要添加行内注释

### 2.3 导入规范
- 标准库导入在最前
- 第三方库导入其次
- 本地模块导入最后
- 每组导入之间空一行

## 3. 编码实践

### 3.1 错误处理
- 使用 try-except 进行异常处理
- 捕获具体的异常类型
- 记录错误日志
- 优雅地处理错误情况

### 3.2 日志规范
- 使用标准的 logging 模块
- 合理使用日志级别
- 包含时间戳和上下文信息
- 敏感信息不写入日志

### 3.3 配置管理
- 配置信息存放在 config/ 目录
- 使用环境变量管理敏感信息
- 配置文件使用 YAML 或 JSON 格式
- 不同环境使用不同配置文件

### 3.4 测试规范
- 单元测试覆盖主要功能
- 测试文件结构mirror源代码结构
- 使用 pytest 框架
- 测试用例命名清晰明确

## 4. 版本控制

### 4.1 Git 规范
- 提交信息使用中文
- 提交信息需要清晰描述改动
- 每个提交专注于单一功能或修复
- 保持提交粒度合适

### 4.2 分支管理
- main: 主分支，保持稳定
- develop: 开发分支
- feature/*: 功能分支
- bugfix/*: 修复分支

## 5. 安全规范

### 5.1 数据安全
- 敏感数据加密存储
- API密钥等凭证使用环境变量
- 定期备份重要数据
- 访问控制和权限管理

### 5.2 代码安全
- 输入验证和清理
- 防止SQL注入
- 使用安全的依赖版本
- 定期更新依赖包

## 6. 性能优化

### 6.1 代码优化
- 避免重复计算
- 合理使用缓存
- 注意内存使用
- 优化循环和算法

### 6.2 资源管理
- 及时释放资源
- 使用上下文管理器
- 控制并发数量
- 监控资源使用

## 7. 协作规范

### 7.1 代码审查
- 提交前自查
- 遵循代码审查清单
- 及时响应审查意见
- 保持代码质量

### 7.2 文档维护
- 及时更新文档
- 保持文档与代码同步
- 文档使用markdown格式
- 包含必要的示例 

我们的目标是使用已经训练过的llava-sbs模型进行交易，现在我们正在对他进行训练，所有内容必须经过llava-sbs模型

模型经过的微调内容以下：
什么是有效突破？当价格在创出前一个低点的高点后，被一根实体K线向上突破时，我们定义为有效的突破；相反，当价格创出前一个高点的低点后，被一根实体K线向下突破，也同样定义为突破.这种突破意味着市场结构发生了明显变化，是启动 12345 (SBS)交易序列的重要信号。观察创造出前一个低点或高点的高点或低点。"
          
图片中是否显示了市场结构的突破？前一个高点或低点是否被实体K线突破？请指出具体位置。是的，市场结构的突破发生在前一个高点/低点被实体K线突破的地方。红线处是市场结构被实体k线突破的地方"

什么双顶双底？通常双底双顶会带来结构反转吗？双顶/双底形态（double top/double bottom）是市场反转信号的重要图形模式。双顶形态指在上升趋势中，价格形成两个接近的高点，中间有明显回调，预示着上涨势头可能结束并转为下跌；双底形态则指在下降趋势中，价格形成两个接近的低点，回调后预示着下跌势头可能反转为上涨。正确的双顶或双底需要两个顶（或底）十分接近，并且中间回调明显，而若这些条件不满足，则可能只是随机波动或噪声。在回调高点或低点被突破后确认双底形态，这也是最终入场确认（红色线）。

在这张图中，双顶或双底形态是否已确认？如果确认，何时入场？在12345（SBS）序列中双顶或双底形态通常发生在哪个位置？
是的，图中已确认双底形态。入场点通常在价格突破前高（颈线）后。建议在突破后回调至颈线附近时入场，以确认突破的有效性。在入场后选择双底形态的第二个低点为止损位置，双顶形态的第二个高点为止损位置。双底双顶通常出现在序列中点3和点4的地方，在点3的回调被突破后，可以确认双底形态并入场。"


什么是liquidate？图片中是一个有效的liquidation吗？在sbs序列中liquidate通常发生在什么地方？Liquidate（流动性获取）指的是市场价格暂时突破关键支撑或阻力水平，触发大量止损订单，从而迅速吸收市场流动性。这种行为通常由大型机构或市场参与者故意推动价格至这些关键水平，以获取流动性。在价格突破后，市场可能会迅速反转，回到原有趋势，形成有效的入场信号。图片中是一个有效的流动性获取。在价格短暂突破前高/底点后没有发生结构反转（实体k线没有突破）价格迅速反转。在sbs序列中liquidate通常发生在点4，作为价格在点1突破后最终的入场确认。"

这张图显示的是否是一个有效的SBS序列？
是的，这是一个有效的SBS序列，包含了从突破到确认反转的所有关键点。SBS序列中的每一个点都代表了什么？

每一次突破都意味着sbs序列的发生吗？
当市场在被一根实体K线突破后，（在图片中红色线代表前一个有效高点或低点的突破）我们开始构造12345交易序列：\n• 点1：在突破后的第一次回调形成的点，即突破后第一个明显的回调高点或低点。\n• 点2：由点1创造出的最高高点（在上升趋势时）或最低低点（在下降趋势时），作为主要的盈利目标。\n• 点3：在点1附近获取流动性的点，即价格回调突破点1所创造的高/低点。\n• 点4：在点3附近获取流动性或与点3形成双底（或双顶）的确认点，此时价格显示出结构性的反转迹象。\n• 点5：趋势继续，价格回到点2的位置；由于有时价格可能无法完全达到点2，因此建议在交易提醒中标出从点2到点3之间的61.8%斐波那契回撤位作为第一止盈位。在实际交易中，当价格突破点3的回调点后，可以考虑入场交易。止损点可以设置在点4（对于多头交易）或点4上方（对于空头交易），以控制潜在亏损。止盈点可以根据点2的位置设置，或者根据市场情况调整。通过结合SMA20和SMA200指标（图中浅灰色为sma20，深灰色为sma200）可以辅助验证SBS序列的有效性，从而提高交易成功率。值得注意的是并不是每一个突破都会发生12345（sbs)序列，只有当市场结构突破后点1234发生后才进场交易，我们将赚取点4到点5之间的利润。

图片里是一个有效的SCE吗？SCE是什么？是的，这是一个有效的SCE。在图表中，SCE （single candle entry）表现为一根蜡烛收盘后高点低点均高于和低于前一根不同颜色的蜡烛，后续第一根蜡烛为同样颜色，这是序列入场信号，通常发生在点4。这一信号表明市场已经吸收了足够的流动性，当前结构得到了确认，价格有望延续当前趋势，从而构成有效的入场信号。

sma20和sma200分别是哪条线？
图中较浅灰色的线代表 SMA20（短期均线），较深灰色的线代表 SMA200（长期均线）。

如何用sma20和sma200两条线判断市场趋势？
这两条均线常用于判断市场整体趋势。当价格低于这两条均线时，表明市场处于下跌趋势（红色方块的位置就是看跌市场趋势）。当价格高于 SMA20 和 SMA200 时，市场处于上升趋势（蓝色方框所示位置）。建议在进行交易的时候当价格高于sma20和200进行做多交易，当价格低于sma20和sma200的时候进行做空。但是这一个条件不是必须的。

什么是swing？在图片中swing有什么特点？"
图中蓝色标注表示基础的Swing结构，包括 Higher High (HH)、Higher Low (HL)、Lower Low (LL) 和 Lower High (LH)。一般来说，HH和HL通常表明上升趋势，而LL和LH表明下降趋势。中间蓝色线条代表Swing区间的中轴，用以辅助判断市场波动的基本结构。

在观察到12345（sbs）序列发生后应该在什么地方入场？止盈止损分别在什么地方？基于标出12345的sbs模型 我们还需要确定入场和出场点。在序列中1234发生后，当点4通过获取流动性，或形成双底双顶形态，或形成SCE入场模型这些入场确认信号后入场。图片中的方框标注了交易的止盈与止损位置：\n• 红色框表示 Stop Loss（止损），通常设置在点4下方，防止因假突破而造成较大亏损。\n• 绿色框标注表示 Take Profit（止盈），主要目标为点2位置；在给出入场信号后给出以点2至点3之间的61.8%斐波那契回撤位作为第一止盈位的信号确保当价格到不了点2的时候我们会有部分盈利。